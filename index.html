<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Gun</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #ff69b4;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        #game-page, #start-game-page {
            text-align: center;
            width: 100%;
        }
        button {
            font-size: 24px;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            border: none;
            border-radius: 10px;
            background-color: #ff69b4;
            color: white;
            width: 200px;
        }
        button:hover {
            background-color: #ff85c2;
        }
        #audio-controls {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 1000;
        }
        #audio-controls button {
            font-size: 16px;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #ff69b4;
            color: white;
            cursor: pointer;
        }
        #audio-controls button:hover {
            background-color: #ff85c2;
        }
        #game {
            width: 100%;
            height: 100vh;
            position: relative;
            cursor: inherit;
            z-index: 1;
        }
        .falling-emoji {
            font-size: 36px;
            position: absolute;
            animation: fall 6s linear infinite;
        }
        @keyframes fall {
            from { top: -50px; }
            to { top: 100%; }
        }
        .heart {
            font-size: 36px;
            position: absolute;
        }
        .gun {
            font-size: 48px;
            position: absolute;
            left: 50%;
            bottom: 80px;
            transform: translateX(-50%) rotate(0deg);
            transform-origin: center bottom;
            white-space: nowrap;
            width: fit-content;
        }
        #score {
            font-size: 24px;
            margin: 10px;
            position: absolute;
            top: 10px;
            left: 10px;
            width: 100px;
            text-align: left;
            z-index: 2;
        }
        #restart-button, #play-next-level-btn {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            border-radius: 10px;
            background-color: #ff69b4;
            color: white;
            z-index: 2;
        }
        #restart-button:hover, #play-next-level-btn:hover {
            background-color: #ff85c2;
        }
        #links-button {
            display: none;
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 16px;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #ff69b4;
            color: white;
            cursor: pointer;
            z-index: 2;
        }
        #links-button:hover {
            background-color: #ff85c2;
        }
        @media screen and (max-width: 768px) {
            .gun {
                font-size: 36px;
                white-space: nowrap;
                width: fit-content;
            }
            .falling-emoji, .heart {
                font-size: 28px;
            }
            #score {
                font-size: 20px;
                width: 80px;
            }
            #restart-button {
                font-size: 20px;
                padding: 8px 16px;
            }
            button {
                font-size: 20px;
                padding: 8px 16px;
            }
            #audio-controls button {
                font-size: 14px;
                padding: 8px;
            }
            #links-button {
                font-size: 14px;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div id="audio-controls">
        <button id="play-pause-btn">Play/Pause Music</button>
    </div>

    <audio id="background-music" src="NIGHTCORE Love Gun.mp3" loop autoplay></audio>

    <div id="start-game-page">
        <button onclick="startGame()">Start Game</button>
    </div>

    <button id="links-button" onclick="goToLinksPage()">Links</button>
    <button id="play-next-level-btn">Play Next Level</button>

    <script>
        const backgroundMusic = document.getElementById('background-music');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const linksButton = document.getElementById('links-button');
        const playNextLevelBtn = document.getElementById("play-next-level-btn");
        let emojiIntervals = [];
        let level = 1;
        let baseSpeed = 1; // Base speed for level 1
        let currentScore = 0; // Initialize the score

        playPauseBtn.addEventListener('click', function() {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                playPauseBtn.textContent = 'Pause Music';
            } else {
                backgroundMusic.pause();
                playPauseBtn.textContent = 'Play Music';
            }
        });

        function startGame() {
            document.getElementById('start-game-page').style.display = 'none';
            linksButton.style.display = 'block';
            initializeGame();
        }

        function initializeGame() {
            const existingGun = document.querySelector('.gun');
            if (existingGun) {
                existingGun.remove(); // Remove the existing gun if it exists
            }

            const gunColor = "black"; // Keep gun color consistent
            const scoreColor = "black"; // Keep score color consistent

            const existingScore = document.getElementById('score');
            if (!existingScore) {  // Only create a new score element if it doesn't exist
                const score = document.createElement('div');
                score.id = 'score';
                score.textContent = `Score: ${currentScore.toString().padStart(3, '0')}`;
                score.style.color = scoreColor;
                document.body.appendChild(score);
            }

            const gun = document.createElement('div');
            gun.className = 'gun';
            gun.textContent = '▄︻デ══‐一';
            gun.style.color = gunColor;
            document.body.appendChild(gun);

            const gameArea = document.createElement('div');
            gameArea.id = 'game';
            document.body.appendChild(gameArea);

            const restartButton = document.createElement('button');
            restartButton.id = 'restart-button';
            restartButton.textContent = 'Play Again';
            restartButton.onclick = restartGame;
            document.body.appendChild(restartButton);

            const emojis = ['😹', '🌽', '🤡🫵', '💉🧬', '🇹🇼', '🌎☮️', '🥩', '🐸', '️‍🔥', '🎲', '🇺🇸', '🥨', '🍆', '🍣', '🇨🇳', '🥧', '🌮', '💩', '👽', '🍉', '🍑', '🚀', '💀'];

            function updateScoreDisplay() {
                const paddedScore = currentScore.toString().padStart(3, '0');
                const scoreElement = document.getElementById('score');
                scoreElement.textContent = `Score: ${paddedScore}`;
            }

            function getAngle(mouseX, mouseY) {
                const rect = gun.getBoundingClientRect();
                const gunX = rect.left + rect.width / 2;
                const gunY = rect.top + rect.height / 2;
                const angle = Math.atan2(mouseY - gunY, mouseX - gunX) * (180 / Math.PI);
                return angle;
            }

            function createFallingEmoji() {
                const emoji = document.createElement('div');
                emoji.classList.add('falling-emoji');
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = Math.random() * 90 + '%';
                gameArea.appendChild(emoji);

                const emojiInterval = setTimeout(() => {
                    if (emoji.parentNode) {
                        gameArea.removeChild(emoji);
                    }
                }, 6000 / baseSpeed); // Emoji fall speed adjusts based on level

                emojiIntervals.push(emojiInterval);

                const creationInterval = setTimeout(createFallingEmoji, Math.random() * 800 + 400);
                emojiIntervals.push(creationInterval);
            }

            function shootEmoji(event) {
                const emoji = document.elementFromPoint(event.clientX, event.clientY);

                if (emoji && emoji.classList.contains('falling-emoji')) {
                    const rect = emoji.getBoundingClientRect();
                    const heart = document.createElement('div');
                    heart.classList.add('heart');
                    heart.textContent = '♡';
                    heart.style.left = rect.left + 'px';
                    heart.style.top = rect.top + 'px';
                    gameArea.appendChild(heart);

                    emoji.remove();
                    currentScore++;  // Continue from the current score
                    updateScoreDisplay();

                    setTimeout(() => {
                        if (heart.parentNode) {
                            gameArea.removeChild(heart);
                        }
                    }, 1000);
                }
            }

            function moveGun(event) {
                const angle = getAngle(event.clientX, event.clientY);
                gun.style.transform = `translateX(-50%) rotate(${angle}deg)`;
            }

            function startFallingEmojis() {
                createFallingEmoji(); 
                setTimeout(endGame, 150000); 
            }

            function endGame() {
                emojiIntervals.forEach(interval => clearInterval(interval));
                emojiIntervals = [];

                const totalTime = level <= 2 ? "2.5 minutes" : "5 minutes"; // Update based on level
                alert(`omg wow! your love gunned down ${currentScore} memojis in ${totalTime} UwU!`);
                gameArea.innerHTML = '';
                document.removeEventListener('mousemove', moveGun);
                document.removeEventListener('click', shootEmoji);
                if (level < 10) {
                    playNextLevelBtn.style.display = 'block';
                } else {
                    restartButton.style.display = 'block';
                }
            }

            playNextLevelBtn.addEventListener('click', () => {
                playNextLevelBtn.style.display = 'none';
                level++;
                baseSpeed *= 1.1; // Increase speed by 10% per level
                initializeGame();  // Restart game with the current score and increased speed
            });

            function restartGame() {
                gameArea.innerHTML = '';
                restartButton.style.display = 'none';
                currentScore = 0;  // Optionally reset score to 0 for a full restart
                level = 1; // Reset to level 1
                baseSpeed = 1; // Reset speed
                initializeGame();
            }

            document.addEventListener('mousemove', moveGun);
            document.addEventListener('click', shootEmoji);
            startFallingEmojis();
        }

        function goToLinksPage() {
            window.location.href = 'https://lovegun.xyz';
        }
    </script>
</body>
</html>
